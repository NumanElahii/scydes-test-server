const { exploitationEvents } = require('../types')
const { sendMessage } = require('../utils/methods')

const sessions = []

const exploitation = (dataFromClient, clients) => {

    console.log("dataFromClient >> exploitation >>> ", dataFromClient)

    switch (dataFromClient.eventType) {
        case exploitationEvents.GET_FILE_DATA:
            sendMessage(clients, JSON.stringify({ eventType: exploitationEvents.GET_FILE_DATA, data: data }))
            break;

        case exploitationEvents.SESSION_FOUND:
            sendMessage(clients, JSON.stringify({ eventType: exploitationEvents.SESSION_FOUND, data: dataFromClient.data }))
            break;

        case exploitationEvents.OPEN_SHELL:
            sendMessage(clients, JSON.stringify({ eventType: exploitationEvents.OPEN_SHELL, data: sessions[0] }))
            break;

        case exploitationEvents.SHELL_COMMAND:
            sendMessage(clients, JSON.stringify({ eventType: exploitationEvents.SHELL_COMMAND, data: dataFromClient.data }))
            break;

        case exploitationEvents.SHELL_COOMAND_OUTPUT:
            sendMessage(clients, JSON.stringify({ eventType: exploitationEvents.SHELL_COOMAND_OUTPUT, data: dataFromClient.data }))
            break;

        case exploitationEvents.CLOSE_SHELL:
            sendMessage(clients, JSON.stringify({ eventType: exploitationEvents.CLOSE_SHELL, data: {} }))
            break;
        default:
            sendMessage(clients, JSON.stringify({ data: dataFromClient.data, eventType: eventType }))
            break;
    }
}


module.exports = {
    exploitation
}